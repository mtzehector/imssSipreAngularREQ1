<app-breadcrumb-ux>
</app-breadcrumb-ux>
<br><br>
<app-menu-ux [rol]="rol"></app-menu-ux>
<div class="row" style="padding: 10px;">
    <div class="col-md-8">
    </div>
    <app-user-profile></app-user-profile>
</div>
<div class="row">
    <div class="col-md-12">
        <h4>Informe de simulación de préstamo</h4>
        <hr class="red" />

    </div>
</div>


<div class="row">
    <div class="col-md-6 tarjeta tarjeta-info-pensionado">
        <div class="row tarjeta-header">
            Información del solicitante
        </div>
        <div class="row tarjeta-body">
            <div class="row tarjeta-title-1">
                <div class="col-md-12">
                    Nombre:
                </div>
            </div>
            <div class="row tarjeta-data-1">
                <div class="col-md-12">
                    {{resumenSimulacion.pensionado.nombre}}&nbsp; {{resumenSimulacion.pensionado.primerApellido}}&nbsp; {{resumenSimulacion.pensionado.segundoApellido}}
                </div>
            </div>
            <div class="row tarjeta-title-1">
                <div class="col-md-6">
                    CURP:
                </div>
                <div class="col-md-6">
                    NSS:
                </div>
            </div>
            <div class="row tarjeta-data-1">
                <div class="col-md-6">
                    {{resumenSimulacion.pensionado.curp}}
                </div>
                <div class="col-md-6">
                    {{resumenSimulacion.pensionado.nss}}
                </div>
            </div>
            <div class="row tarjeta-title-1">
                <div class="col-md-6">
                    Delegación:
                </div>
                <div class="col-md-6">
                    Tel&eacute;fono m&oacute;vil:
                </div>
            </div>
            <div class="row tarjeta-data-1">
                <div class="col-md-6">
                    {{resumenSimulacion.pensionado.delegacion.descDelegacion}}
                </div>
                <div class="col-md-6">
                    {{resumenSimulacion.personaModel.telCelular}}
                </div>
            </div>
            <div class="row tarjeta-title-1">
                <div class="col-md-6">
                    Correo electr&oacute;nico:
                </div>
                <div class="col-md-6">
                    Tipo de trabajador:
                </div>
            </div>
            <div class="row tarjeta-data-1">
                <div class="col-md-6">
                    {{resumenSimulacion.personaModel.correoElectronico}}
                </div>
                <div class="col-md-6">
                    PENSIONADO
                </div>
            </div>
            <div class="row tarjeta-title-1">
                <div class="col-md-6">
                    Tipo de pensión:
                </div>
                <div class="col-md-6">
                    Tipo de crédito:
                </div>
            </div>
            <div class="row tarjeta-data-1">
                <div class="col-md-6">
                    {{resumenSimulacion.pensionado.tipoPension}}
                </div>
                <div class="col-md-6">
                    {{nuevo.tipoCreditoEnum.descripcion}}
                </div>
            </div>
            <div class="row tarjeta-title-1">
                <div class="col-md-6">
                    Origen del préstamo:
                </div>
            </div>
            <div class="row tarjeta-data-1">
                <div class="col-md-6">
                    {{resumenSimulacion.solicitud.cveOrigenSolicitud.desOrigenSolicitud}}
                </div>
            </div>
        </div>
    </div>

    <div class="col-md-6 tarjeta tarjeta tarjeta-info-ef">
        <div class="row tarjeta-header">
            Entidad Financiera elegida
        </div>
        <div class="row tarjeta-body">
            <div class="row">
                <div class="col-md-12" style="text-align: center;">
                    <img [src]="imgEFUrl" alt="Sin imagen">
                </div>
            </div>
            <div class="row tarjeta-title-1">
                <div class="col-md-6">
                    Nombre comercial:
                </div>
                <div class="col-md-6">
                    Teléfono:
                </div>
            </div>
            <div class="row tarjeta-data-1-bold">
                <div class="col-md-6">
                    {{resumenSimulacion.oferta.entidadFinanciera.nombreComercial}}
                </div>
                <div class="col-md-6">
                    {{resumenSimulacion.oferta.entidadFinanciera.numTelefono}}
                </div>
            </div>
            <div class="row tarjeta-title-1">
                <div class="col-md-12">
                    Página web:
                </div>
            </div>
            <div class="row tarjeta-data-1">
                <div class="col-md-12">
                    <a href="https://{{resumenSimulacion.oferta.entidadFinanciera.paginaWeb}}">{{resumenSimulacion.oferta.entidadFinanciera.paginaWeb}}
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>


<div class="row tarjeta">
    <div class="row tarjeta-header">
        Personal operativo
    </div>
    <div class="row tarjeta-body">
        <div class="col-md-4">
            <img [src]="imgPromotorUrl" alt="Sin imagen" style="max-width: 250px; max-height: 150px;">
        </div>
        <div class="col-md-8">
            <div class="row tarjeta-title-1">
                <div class="col-md-6">
                    Nombre:
                </div>
                <div class="col-md-6">
                    Teléfono móvil:
                </div>
            </div>
            <div class="row tarjeta-data-1">
                <div class="col-md-6">
                    {{ resumenSimulacion.promotor.nombre}} {{ resumenSimulacion.promotor.primerApellido}} {{ resumenSimulacion.promotor.segundoApellido}}
                </div>
                <div class="col-md-6">
                    {{ resumenSimulacion.promotor.telefono}}
                </div>
            </div>
            <div class="row tarjeta-title-1">
                <div class="col-md-12">
                    Correo Electrónico:
                </div>
            </div>
            <div class="row tarjeta-data-1">
                <div class="col-md-12">
                    {{ resumenSimulacion.promotor.correoElectronico}}
                </div>
            </div>
        </div>
    </div>
</div>

<div class="row tarjeta">
    <div class="row tarjeta-header">
        Información de la simulación
    </div>
    <div class="row tarjeta-body">
        <div class="row tarjeta-title-1">
            <div class="col-md-3">
                CAT con IVA:
                <span class="glyphicon glyphicon-question-sign" aria-hidden="true" data-toggle="tooltip" data-placement="bottom" title="
Costo Anual Total:
Monto total a pagar
cada año, incluyendo
la tasa de interés
anual y otros costos
del préstamo.">
                </span>
            </div>
            <div class="col-md-3">Monto solicitado:</div>
            <div class="col-md-3">Descuento mensual:
                <span class="glyphicon glyphicon-question-sign" aria-hidden="true" data-toggle="tooltip" data-placement="bottom" title="
Es el monto que se
te descontará
mensualmente a lo
largo del préstamo."></span>
            </div>
            <div class="col-md-3">Plazo:</div>
        </div>

        <div class="row tarjeta-data-1">
            <div class="col-md-3 tarjeta-data-1-bold">{{resumenSimulacion.oferta.cat}}%</div>
            <div class="col-md-3">${{resumenSimulacion.prestamo.monto | number:'0.2-2'}}</div>
            <div class="col-md-3 tarjeta-data-1-bold">${{resumenSimulacion.prestamo.impDescNomina | number:'0.2-2'}}
            </div>
            <div class="col-md-3 tarjeta-data-1-bold">{{resumenSimulacion.oferta.plazo.descripcion}}</div>
        </div>

        <div class="row tarjeta-title-1">
            <div class="col-md-3">
                Importe total a pagar: <span class="glyphicon glyphicon-question-sign" aria-hidden="true" data-toggle="tooltip" data-placement="bottom" title="Es el importe total
del préstamo más
los intereses y costos
cubiertos durante la
vida del crédito."></span>
            </div>
            <div class="col-md-3">
                Fecha del primer descuento:<span class="glyphicon glyphicon-question-sign" aria-hidden="true" data-toggle="tooltip" data-placement="bottom" title="Esta fecha está sujeta
de cambio, conforme a la
fecha de autorización
del préstamo."></span></div>
            <div class="col-md-3">Fecha de registro:</div>
            <div class="col-md-3">Fecha de vigencia del folio:</div>
        </div>

        <div class="row tarjeta-data-1">
            <div class="col-md-3 tarjeta-data-1-bold">${{resumenSimulacion.prestamo.impTotalPagar | number:'0.2-2'}}
            </div>
            <div class="col-md-3">{{this.fecha}}</div>
            <div class="col-md-3">{{resumenSimulacion.solicitud.altaRegistro| slice:0:10}}</div>
            <div class="col-md-3">{{resumenSimulacion.solicitud.fecVigenciaFolio| slice:0:10}}</div>
        </div>

    </div>
</div>

<div class="row tarjeta">
    <div class="row tarjeta-header">
        Préstamos por liquidar
    </div>
    <div class="sin-info col-md-12" *ngIf="flagConPrestamos==0">
        <h4>No hay préstamos por liquidar.</h4>
    </div>
    <span *ngFor="let item of resumenSimulacion.listPrestamoRecuperacion.prestamosEnRecuperacion; let i = index">
        <div class="row tarjeta-body">
            <div class="row tarjeta-data-1">
                Entidad Financiera: <span class="tarjeta-data-1-bold">{{item.nombreComercial}}</span>
</div>
<div class="row tarjeta-title-1">
    <div class="col-md-2">CAT con IVA:</div>
    <div class="col-md-3">Monto solicitado:</div>
    <div class="col-md-2">Descuento Mensual:</div>
    <div class="col-md-3">Descuentos / Plazo:</div>
    <div class="col-md-2">Saldo capital:
        <span class="glyphicon glyphicon-question-sign" aria-hidden="true" data-toggle="tooltip" data-placement="bottom" title="Saldo capital"></span>
    </div>
</div>
<div class="row tarjeta-data-1">
    <div class="col-md-2 tarjeta-data-1-bold">{{item.canCatPrestamo | number:'0.2-2'}} %</div>
    <div class="col-md-3">${{item.impRealPrestamo | number:'0.2-2'}}</div>
    <div class="col-md-2 tarjeta-data-1-bold">${{item.canDescuentoMensual | number:'0.2-2'}}</div>
    <div class="col-md-3 tarjeta-data-1-bold">{{item.numMesRecuperado}} / {{item.numPlazoPrestamo}}</div>
    <div *ngIf="!item.flagEditMont">
        <div *ngIf="item.canMontoSol != null" class="col-md-2">${{item.canMontoSol | number:'0.2-2'}}</div>
        <div *ngIf="item.canMontoSol == null" class="col-md-2">${{item.saldoCapital | number:'0.2-2'}}</div>
    </div>
    <div *ngIf="item.flagEditMont" class="col-md-2">
        <input class="form-control inputSaldoCapital" [(ngModel)]="item.saldoCapital" (change)="validarMonto();"  placeholder="Ingresa monto" name="salCap" #salCap="ngModel" required appTwoDigitDecimalNumber>
        <div style="width: max-content;">
            <div *ngIf="salCap.invalid && salCap.touched">
                <div *ngIf="salCap.errors.required">
                    <p class="error-class">El monto es obligatorio.</p>
                </div>
            </div>
            <div *ngIf="salCap.touched && salCap.dirty">
                <div *ngIf="this.flagErrorMonto && item.numSolicitudSipre == this.solicitado">
                    <p class="error-class">El monto ingresado<br>no puede superar la<br>suma de dos meses<br>de descuento.</p>
                </div>
            </div>
        </div>
    </div>
</div>
</div>
<br>
</span>
</div>

<!--div class="container">

    <table class="table table-striped">
        <thead>
            <tr>
                <th scope="col">Informe de Simulaci&oacute;n</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>Folio: {{cartaInstruccion.solicitud.numFolioSolicitud}}</td>
            </tr>
        </tbody>
    </table>
</div>
<div class="container">

    <!--  TABLA DE DATOS GENERALES >
    <table class="table table-striped">
        <thead>
            <tr>
                <th scope="col">Información del solicitante</th>
                <th scope="col"></th>
                <th scope="col"></th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <th scope="col">Nombre(s): </th>
                <th scope="col">Primer apellido: </th>
                <th scope="col"> Segundo apellido: </th>
            </tr>

            <tr>
                <td scope="col" style="width: 33%;">{{cartaInstruccion.pensionado.nombre}}</td>
                <td scope="col" style="width: 33%;">{{cartaInstruccion.pensionado.primerApellido}}</td>
                <td scope="col" style="width: 33%;">{{cartaInstruccion.pensionado.segundoApellido}}</td>
            </tr>
            <tr>
                <th scope="col">CURP: </th>
                <th scope="col">NSS: </th>
                <th scope="col">Tel&eacute;fono móvil: </th>
            </tr>

            <tr>
                <td scope="col" style="width: 33%;">{{cartaInstruccion.solicitud.curp}}</td>
                <td scope="col" style="width: 33%;">{{cartaInstruccion.solicitud.nss}}</td>
                <td scope="col" style="width: 33%;">{{cartaInstruccion.personaModel.telCelular}}</td>
            </tr>

            <tr>
                <th colspan="3">Correo electr&oacute;nico:</th>

            </tr>

            <tr>
                <td colspan="3">{{this.cartaInstruccion.personaModel.correoElectronico}}</td>

            </tr>


            <tr>

                <th scope="col">Tipo de trabajador:</th>
                <th scope="col">Tipo de pensi&oacute;n: </th>
                <th scope="col"> Tipo de cr&eacute;dito: </th>
            </tr>
            <tr>

                <td scope="col" style="width: 33%;"> {{cartaInstruccion.solicitud.refTrabajador | uppercase}}</td>
                <td scope="col" style="width: 33%;"> {{cartaInstruccion.pensionado.tipoPension | uppercase}}</td>
                <td scope="col" style="width: 33%;"> {{nuevo.tipoCreditoEnum.descripcion | uppercase}}</td>
            </tr>

        </tbody>
    </table>

    <!-- FIN  TABLA DE DATOS GENERALES >
</div>
<div class="container">
    <div class="col-md-12">
        <div class="row">
            <!-- TABLA DE ENTIDAD FNANCIERA >

            <table class="table table-striped">
                <thead>
                    <tr>
                        <th scope="col">Entidad Financiera</th>
                        <th scope="col"></th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <th scope="col">Nombre comercial: </th>
                        <th scope="col">Tel&eacute;fono: </th>
                        <th scope="col">P&aacute;gina web:</th>

                    </tr>
                    <tr>

                        <td scope="col" style="width: 33%;">{{cartaInstruccion.oferta.entidadFinanciera.nombreComercial}}</td>
                        <td scope="col" style="width: 33%;">{{cartaInstruccion.oferta.entidadFinanciera.numTelefono}} </td>
                        <td scope="col" style="width: 33%;"><a href="https://{{cartaInstruccion.oferta.entidadFinanciera.paginaWeb}}">{{cartaInstruccion.oferta.entidadFinanciera.paginaWeb}} </a></td>

                    </tr>
                </tbody>
            </table>

            <!-- TABLA DE ENTIDAD FNANCIERA FIN >



        </div>
    </div>
</div>

<app-promotor-datos></app-promotor-datos>
<div class="container">

    <!--TABLA DE CONDICIONES DE LA SIMULACION >
    <table class="table table-striped">
        <thead>
            <tr>
                <th scope="col" colspan="3">Condiciones de la Simulaci&oacute;n</th>

            </tr>
        </thead>
        <tbody>
            <tr>
                <th scope="col">Monto solicitado:</th>
                <th scope="col">Importe total a pagar: </th>
                <th scope="col">Descuento mensual:</th>
            </tr>

            <tr>
                <td scope="col" style="width: 33%;">$ {{cartaInstruccion.prestamo.monto | number:'0.2-2'}}</td>
                <td scope="col" style="width: 33%;">$ {{cartaInstruccion.prestamo.impTotalPagar | number:'0.2-2'}}</td>
                <td scope="col" style="width: 33%;">$ {{cartaInstruccion.prestamo.impDescNomina | number:'0.2-2'}}</td>
            </tr>
            <tr>
                <th scope="col"> CAT con IVA: </th>
                <th scope="col">Plazo: </th>
                <th scope="col">Fecha del primer descuento:</th>
            </tr>
            <tr>
                <td scope="col" style="width: 33%;"> {{cartaInstruccion.oferta.cat}} %</td>
                <td scope="col" style="width: 33%;">{{cartaInstruccion.oferta.plazo.descripcion}}</td>
                <td scope="col" style="width: 33%;">{{fechaPrimerDescuetno}}</td>
            </tr>

        </tbody>
    </table>

    <!--  FIN DE LA TABLA DE CONDICIONES DE LA SIMULACION >
</div>
<div class="container" *ngIf="this.listPrestamoRecuperacion.prestamosEnRecuperacion.length > 0">

    <!--TABLA DATOS DEL PRESTAMO A LIQUIDAR>
    <table class="table table-striped">
        <thead>
            <tr>
                <th scope="col" colspan="4">Datos del préstamo a liquidar</th>
            </tr>
        </thead>
        <tbody *ngFor="let prestamosRec of this.listPrestamoRecuperacion.prestamosEnRecuperacion">
            <td></td>
            <tr>
                <th scope="col">Nombre comercial:</th>
                <th scope="col">Folio: </th>
                <th scope="col">Descuento mensual:</th>
                <th scope="col">Monto prestado:</th>

            </tr>

            <tr>
                <td scope="col" style="width: 33%;">{{prestamosRec.nombreComercial}}</td>
                <td scope="col" style="width: 22%;">{{prestamosRec.numSolicitudSipre}}</td>
                <td scope="col" style="width: 22%;">${{prestamosRec.canDescuentoMensual | number:'0.2-2'}}</td>
                <td scope="col" style="width: 22%;">${{prestamosRec.impRealPrestamo | number:'0.2-2'}}</td>

            </tr>
            <tr>
                <th scope="col">CAT con IVA:</th>
                <th scope="col">Mensualidades descontadas / Plazo:</th>
                <th scope="col">Saldo Capital: </th>
                <th scope="col">&nbsp;</th>
            </tr>
            <tr>
                <td scope="col" style="width: 33%;">{{prestamosRec.canCatPrestamo}}%</td>
                <td scope="col" style="width: 33%;">{{prestamosRec.numMesRecuperado}} / {{prestamosRec.numPlazoPrestamo}}</td>
                <td scope="col" style="width: 33%;">${{prestamosRec.saldoCapital | number:'0.2-2'}}</td>
                <td scope="col" style="width: 1%;"> &nbsp;</td>
            </tr>

        </tbody>
    </table>

    <  FIN DE LA TABLA DE CONDICIONES DE LA SIMULACION >
</div-->

<br>


<div class="row">
    <div class="col-md-6"></div>
    <div class="col-md-6" style="text-align: right;">
        <a class="btn btn-default" routerLink="../buscarFolioDetalle" role="button">Regresar</a> &nbsp;
        <button (click)="confirmarMonto();" class="btn btn-primary " [disabled]="this.flagErrorMonto || this.flagMontoVacio">
            <span class="oi oi-undefined glyphicon glyphicon-undefined"></span>Continuar
        </button>

        <br><br>
    </div>
</div>

<jw-modal id="carga">
    <div class="jw-modal-titulo"> <b>Atención</b></div>
    <div style="height:100%; width:100%">
        <br>
        <br>
        <p style="text-align:center"><b>Cargando datos</b></p>
        <div align="center">
            <div class="preloader"></div>
        </div>

        <br>
    </div>
</jw-modal>
<jw-modal id="preguntaRegistroMonto">
    <div class="jw-modal-titulo"> <b>Atención</b></div>
    <div style="height:100%; width:100%">
        <br>
        <br>
        <p style="text-align:center"><b> ¿El monto capital $ {{suma | number:'0.2-2'}} es correcto?</b></p>
        <div style="text-align:right">
            <button type="button" class="btn btn-primary" (click)="guardarSaldos();">
                <span class="oi oi-send glyphicon glyphicon-left"> </span>Si
            </button>&nbsp;
            <button type="button" class="btn btn-default" (click)="continuarNo()">
                <span class="oi oi-send glyphicon glyphicon-left"> </span>No
            </button>
        </div>
        <br>
    </div>
</jw-modal>